<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>.b[ECON 3640–001]</title>
    <meta charset="utf-8" />
    <meta name="author" content=".b[Marcio Santetti]   Spring 2022" />
    <script src="ps3-sp22_files/header-attrs-2.11/header-attrs.js"></script>
    <link href="ps3-sp22_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="ps3-sp22_files/remark-css-0.0.1/metropolis.css" rel="stylesheet" />
    <link href="ps3-sp22_files/remark-css-0.0.1/metropolis-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="a-css.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# .b[ECON 3640–001]
## .hi[Problem Set 3]
### .b[Marcio Santetti] <br> Spring 2022

---

layout: true
class: clear
---

## Problem 1

&lt;br&gt;

(a) Simulate 1,000 values drawn from a .b[Poisson]-distributed random variable, with rate parameter 16. Do not forget to set a .b[seed] for reproducibility.

(b) Generate 10,000 values drawn from a .b[Beta]-distributed random variable, with shape parameters 10 and 15. Do not forget to set a .b[seed] for reproducibility.

(c) Generate 1,000 values drawn from a .b[uniformly]-distributed random variable, ranging from 0 to 20. Do not forget to set a .b[seed] for reproducibility.

(d) Repeat part (c), now simulating 10,000 values. Produce a histogram for both parts, and compare your results.

(e) Generate 5,000 draws from a Normal distribution, with mean 5 and standard deviation 2. Generate these simulated data's density curve, and put, on the same plot, its long-run probability density function (PDF) curve. Compare your results. Do not forget to set a .b[seed] for reproducibility.


## Problem 2

&lt;br&gt;


Consider the following model:

$$
`\begin{aligned}
Y|\theta  \sim \text{Binomial}(n, \theta) \\
\theta  \sim \text{Beta}(3,8)
\end{aligned}`
$$
Approximate the posterior distribution, `\(\theta|Y\)`, using .b[grid approximation]. How "thin" the grid will be is up to you, but make sure to play around with different values. 

Lastly, assume that you observe `\(n = 100\)` trials, with `\(Y=5\)` successes.

## Problem 3

&lt;br&gt;

Use .b[grid approximation] to estimate the posterior distribution for a Gamma-Poisson model, where you observe `\(n = 3\)` independent data points `\((Y_1, Y_2, Y_3) = (0,1,0)\)`. The likelihood and prior are the following:

$$
`\begin{aligned}
Y_i|\lambda  \sim \text{Poisson}(\lambda) \\
\lambda  \sim \text{Gamma}(20,5)
\end{aligned}`
$$

---
class:clear

## Problem 4

&lt;br&gt;

Using `stan` syntax, set up the `model{}` block of a model string for an MCMC simulation for the following priors and likelihood functions:

(a) `\(Y|\theta \sim \text{Binomial}(20, \theta)\)` and `\(\theta \sim \text{Beta}(1,1)\)`;

(b) `\(Y|\lambda \sim \text{Poisson}(\lambda)\)` and `\(\lambda \sim \text{Gamma}(4,2)\)`;

(c) `\(Y|\mu \sim \mathcal{N}(\mu, 1)\)` and `\(\mu \sim \mathcal{N}(0, 10)\)`;

(d) `\(Y|\mu \sim \mathcal{N}(\mu, \sigma)\)`, with `\(\mu \sim \mathcal{N}(0, 10)\)` and `\(\sigma \sim \text{Uniform}(0, 100)\)`.


## Problem 5

&lt;br&gt;

Using the information from .b[Problem 2], set up an .b[MCMC] simulation using `rstan` with 4 chains and 10,000 iterations. Then, do the following:

(a) Generate trace plots for your Markov chains. Did they converge?

(b) Generate the density plots of your parameter. Are these densities similar to each other?

(c) What is the posterior mean of your parameter?

(d) Interpret the 95% credibility interval you've obtained from your simulation.



## Problem 6

&lt;br&gt;

Using the `howell.csv` data set (available on Canvas), run an MCMC simulation to approximate the posterior distribution for the average *height*, but only for adults (i.e., individuals older than 18 years old). In other words, make sure to apply the `filter()` function to your data set first. 

You may assume, for simplicity, that the standard deviation parameter, `\(\sigma\)`, is constant and known. You may use any value you want, as long as it makes sense. Recall that, if your data are normally distributed, approximately 95% of the observations lie within 2 standard deviations of the mean, or `\(\mu \pm 2 \cdot \sigma\)`. Take this detail into account when setting up your Bayesian model.

Answer the same questions from Problem 5. 

---
class:clear

## Problem 7

&lt;br&gt;

Still using the `howell.csv` data set, now estimate a Bayesian model for the posterior distributions for *weights* (in kilograms). This time, you will have to set a prior for `\(\sigma\)` as well.

Here, make sure to play around with models including every individual in the sample, but also for adults only.

As a bonus, you may estimate models also based on `gender` since, these data are also available in this data set. With different research questions in mind, make sure to think about your priors and adjust your data accordingly.



---
exclude:true
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "8.5:11",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
